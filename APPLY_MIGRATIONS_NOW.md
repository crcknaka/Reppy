# üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è "–ü–ª–∞–Ω–∫–∞"

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –ë–ï–ó –≠–¢–ò–• –®–ê–ì–û–í –ü–õ–ê–ù–ö–ê –ù–ï –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨!

–°–µ–π—á–∞—Å –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö **–Ω–µ –∑–Ω–∞–µ—Ç** –æ –Ω–æ–≤–æ–º —Ç–∏–ø–µ `timed` –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏ "–ü–ª–∞–Ω–∫–∞". –ù—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏.

---

## üìã –®–∞–≥–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: https://supabase.com/dashboard

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor

–í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **SQL Editor** (–∏–∫–æ–Ω–∫–∞ —Å —Å–∏–º–≤–æ–ª–æ–º `</>`).

### 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç SQL –∫–æ–¥

```sql
-- ============================================
-- –ü–û–õ–ù–ê–Ø –ú–ò–ì–†–ê–¶–ò–Ø –î–õ–Ø –î–û–ë–ê–í–õ–ï–ù–ò–Ø –¢–ò–ü–ê "TIMED"
-- –ò –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø "–ü–õ–ê–ù–ö–ê" (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)
-- ============================================

-- –®–ê–ì 1: –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –ø–æ–ª–µ plank_seconds –≤ —Ç–∞–±–ª–∏—Ü—É workout_sets
ALTER TABLE public.workout_sets
ADD COLUMN IF NOT EXISTS plank_seconds integer;

-- –®–ê–ì 2: –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏
COMMENT ON COLUMN public.workout_sets.plank_seconds IS '–í—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —Ç–∏–ø–∞ timed (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–ª–∞–Ω–∫–∞)';

-- –®–ê–ì 3: –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–∏–ø —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è 'timed'
DO $$
BEGIN
    IF NOT EXISTS (
        SELECT 1 FROM pg_enum
        WHERE enumlabel = 'timed'
        AND enumtypid = (SELECT oid FROM pg_type WHERE typname = 'exercise_type')
    ) THEN
        ALTER TYPE exercise_type ADD VALUE 'timed';
    END IF;
END $$;

-- –®–ê–ì 4: –î–æ–±–∞–≤–ª—è–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ "–ü–ª–∞–Ω–∫–∞" (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç)
INSERT INTO public.exercises (name, type, is_preset, image_url)
SELECT '–ü–ª–∞–Ω–∫–∞', 'timed'::exercise_type, true, '/exercises/planka.jpg'
WHERE NOT EXISTS (
  SELECT 1 FROM public.exercises WHERE name = '–ü–ª–∞–Ω–∫–∞' AND is_preset = true
);

-- –®–ê–ì 5: –ò—Å–ø—Ä–∞–≤–ª—è–µ–º constraint –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–ª–∞–Ω–∫–∏
-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π constraint –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç –æ–±–∞ –ø–æ–ª—è –∫–∞—Ä–¥–∏–æ
ALTER TABLE public.workout_sets DROP CONSTRAINT IF EXISTS workout_sets_cardio_check;

-- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π constraint: –∫–∞—Ä–¥–∏–æ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–∏–±–æ –æ–±–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, –ª–∏–±–æ –æ–±–∞ –ø—É—Å—Ç—ã–µ
ALTER TABLE public.workout_sets ADD CONSTRAINT workout_sets_cardio_check
CHECK (
  -- –õ–∏–±–æ –æ–±–∞ –ø–æ–ª—è –∫–∞—Ä–¥–∏–æ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤–º–µ—Å—Ç–µ
  (distance_km IS NOT NULL AND duration_minutes IS NOT NULL)
  -- –õ–∏–±–æ –æ–±–∞ –ø–æ–ª—è –∫–∞—Ä–¥–∏–æ –ø—É—Å—Ç—ã–µ
  OR (distance_km IS NULL AND duration_minutes IS NULL)
);
```

### 4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **RUN** (–∏–ª–∏ `Ctrl+Enter`)

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏.

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
SELECT enumlabel FROM pg_enum e
JOIN pg_type t ON e.enumtypid = t.oid
WHERE t.typname = 'exercise_type';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
SELECT name, type FROM exercises WHERE name = '–ü–ª–∞–Ω–∫–∞';
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –í –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å: `bodyweight`, `weighted`, `cardio`, `timed`
- –í–æ –≤—Ç–æ—Ä–æ–º: `–ü–ª–∞–Ω–∫–∞ | timed`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—è plank_seconds
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'workout_sets' AND column_name = 'plank_seconds';
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: `plank_seconds | integer | YES`

---

## ‚úÖ –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

1. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `Ctrl+Shift+R` (Windows) –∏–ª–∏ `Cmd+Shift+R` (Mac)
2. –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ **"–ü–ª–∞–Ω–∫–∞"** –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
3. –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–¥—Ö–æ–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ **"–í—Ä–µ–º—è (—Å–µ–∫)"** –≤–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
4. –í—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç! üéâ

---

## üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `planka.jpg` –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Supabase Storage –ø–æ –ø—É—Ç–∏:
```
/exercises/planka.jpg
```

–ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** ‚Üí **exercises** (—Å–æ–∑–¥–∞–π—Ç–µ bucket, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ `planka.jpg`
3. –ü—É—Ç—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: `exercises/planka.jpg`

---

## üîç –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### 1. **–ù–æ–≤—ã–π —Ç–∏–ø —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è**
```sql
exercise_type ENUM: 'bodyweight' | 'weighted' | 'cardio' | 'timed'
```

### 2. **–ù–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ**
| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| name | –ü–ª–∞–Ω–∫–∞ |
| type | timed |
| is_preset | true |
| image_url | /exercises/planka.jpg |

### 3. **–ù–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–ª–∞–Ω–∫–∏**
–¢–∞–±–ª–∏—Ü–∞ `workout_sets` —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ:
- `plank_seconds` (integer, nullable) - –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (–ø–ª–∞–Ω–∫–∞) —Ö—Ä–∞–Ω–∏—Ç **—Å–µ–∫—É–Ω–¥—ã**
- `duration_minutes` (integer, nullable) - –æ—Å—Ç–∞–µ—Ç—Å—è –¥–ª—è –∫–∞—Ä–¥–∏–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (–±–µ–≥)

---

## ‚ùì –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "enumlabel already exists"
–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ó–Ω–∞—á–∏—Ç —Ç–∏–ø `timed` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω. –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ.

### –û—à–∏–±–∫–∞: "duplicate key value"
–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ "–ü–ª–∞–Ω–∫–∞" —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ. –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ!

### –û—à–∏–±–∫–∞ 400 –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–¥—Ö–æ–¥–∞
–ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —à–∞–≥—É 3 –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç.

---

## üìÅ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

- `supabase/FULL_MIGRATION_TIMED.sql` - –ø–æ–ª–Ω—ã–π SQL —Å–∫—Ä–∏–ø—Ç
- `supabase/CHECK_DATABASE.sql` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î
- `MIGRATION_TIMED_EXERCISE.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
